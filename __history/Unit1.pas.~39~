unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Error, FireDAC.UI.Intf,
  FireDAC.Phys.Intf, FireDAC.Stan.Def, FireDAC.Stan.Pool, FireDAC.Stan.Async,
  FireDAC.Phys, FireDAC.Phys.MySQL, FireDAC.Phys.MySQLDef, FireDAC.VCLUI.Wait,
  FireDAC.Stan.Param, FireDAC.DatS, FireDAC.DApt.Intf, FireDAC.DApt, Data.DB,
  FireDAC.Comp.DataSet, FireDAC.Comp.Client;

type
  TForm1 = class(TForm)
    Panel1: TPanel;
    Button1: TButton;
    edtID: TEdit;
    edtName: TEdit;
    edtPW: TEdit;
    FDConnection1: TFDConnection;
    FDQuery1: TFDQuery;
    FDQuery2: TFDQuery;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
begin
  if edtID.Text = '' then
    begin
      Self.ModalResult := mrNone;
      ShowMessage('아이디가 비어있습니다.');
      edtID.SetFocus;
      Exit;
    end;

    if edtName.Text = '' then
    begin
      Self.ModalResult := mrNone;
      ShowMessage('이름이 비어있습니다.');
      edtName.SetFocus;
      Exit;
    end;

    if edtPW.Text = '' then
    begin
      Self.ModalResult := mrNone;
      ShowMessage('비밀번호가 비어있습니다.');
      edtPw.SetFocus;
      Exit;
    end;

    FDQuery2.SQL.Text := 'SELECT * FROM auth WHERE loginId = :loginId';
    FDQuery2.ParamByName('loginId').AsString := edtName.Text;
    FDQuery2.Open;
  if FDQuery2.IsEmpty then
  begin
    ShowMessage('회원가입이 완료되었습니다.');
    Self.ModalResult := mrOK;
  end
  else
  begin
    Self.ModalResult := mrNone;
    ShowMessage('중복되는 아이디입니다.');
  end;

  FDQuery1.SQL.Text := 'INSERT INTO auth(loginId, display_name, pw) VALUES (:loginId, :display_name, :pw)';
  FDQuery1.ParamByName('loginId').AsString := edtID.Text;
  FDQuery1.ParamByName('display_name').AsString := edtName.Text;
  FDQuery1.ParamByName('pw').AsString := edtPW.Text;
  FDQuery1.ExecSQL;



  

end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  FDConnection1.DriverName := 'MySQL';
  FDConnection1.Params.Add('Server=localhost');
  FDConnection1.Params.Add('CharacterSet=utf8');
  FDConnection1.Params.Add('Database=conbetra');
  FDConnection1.Params.Add('User_Name=conbetra_root');
  FDConnection1.Params.Add('Password=1234');
end;

procedure TForm1.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
if Key = VK_ESCAPE then Self.ModalResult := mrNone;
if Key = VK_RETURN then Button1.Click;
end;

end.
